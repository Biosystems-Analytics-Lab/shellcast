{% extends "base.html.jinja" %}

{% block additional_head %}
  <!-- Bootstrap Table -->
  <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">
  <script defer src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>

  <!-- Custom JS -->
  <script defer src="https://maps.googleapis.com/maps/api/js?key= {{- mapsAPIKey -}} "></script>
  <script defer src="{{ url_for('static', filename='index/index.js') }}"></script>
  <!-- Custom CSS -->
  <link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='index/index.css') }}">
{% endblock %}

{% block content %}
  <div class="text-justify">
    <p id="disclaimer">
      ShellCast forecasts offer predictions that are in no way indicative of whether or not a
      growing area will actually be temporarily closed for harvest. Please only use ShellCast 
      for planning purposes. For official information on closures, refer to the
      <a href="http://portal.ncdenr.org/web/mf/proclamations-polluted-areas">North Carolina Division of Marine Fisheries</a> 
      or the <a href="https://ncdenr.maps.arcgis.com/apps/webappviewer/index.html?id=5759aa19d7484a3b82a8e440fba643aa">Shellfish Sanitation Temporary Closure Public Viewer</a>.
      Learn more about ShellCast forecasts on the <a href="/about">About</a> page.
    </p>
    <div class="date-info">
      <div>
        <p><strong>Last updated:</strong> {{lastUpdated}} ({{hoursAgo}} hours ago)</p>
      </div>
      <div>
        <p><strong>1-day:</strong> {{day1}}</p>
        <p><strong>2-day:</strong> {{day2}}</p>
        <p><strong>3-day:</strong> {{day3}}</p>
      </div>
      <a href="#closure-tables">Table View</a>
    </div>
    <p>Growing areas shown below are colored by % chance of closure. The colors are defined in a legend on the map. For more information on the forecast, see the <a href="/about">About page</a>.</p>
  </div>

  <div id="closure-map"></div>
  <label class="sr-only" for="closure-map" id="Map alt text">A satellite image of North Carolina with shellfish growing areas colored based on the percent chance of temporary harvest closure.</label>

  <br>

  <div id="closure-tables">

    <div id="lease-table-div">
      <div id="lease-table-toolbar">
        <h4>My Leases</h4>
      </div>
      <table
        id="lease-table"
        data-classes="table table-bordered table-hover table-sm"
        data-toggle="table"
        data-search="true"
        data-height="200"
        data-toolbar="#lease-table-toolbar">
        <thead>
          <tr>
            <th data-sortable="true" data-field="ncdmf_lease_id">Lease ID</th>
            <th data-field="prob_1d_perc">1-day (%)</th>
            <th data-field="prob_2d_perc">2-day (%)</th>
            <th data-field="prob_3d_perc">3-day (%)</th>
          </tr>
        </thead>
      </table>
    </div>

    <div id="lease-table-explanation">
      <p>
        To see forecasts specifically for your lease sites and to add lease
        location pins to the map above, add leases to your account.
        You can add leases by clicking "Manage preferences" in the top right
        of this page.
      </p>
    </div>

    <div id="area-table-div">
      <div id="area-table-toolbar">
        <h4>NCDMF Shellfish Growing Areas</h4>
      </div>
      <table
        id="area-table"
        data-classes="table table-bordered table-hover table-sm"
        data-toggle="table"
        data-search="true"
        data-height="200"
        data-toolbar="#area-table-toolbar">
        <thead>
          <tr>
            <th data-sortable="true" data-field="grow_area">Grow Area</th>
            <th data-field="min_max_1d_prob">1-day Min / Max (%)</th>
            <th data-field="min_max_2d_prob">2-day Min / Max (%)</th>
            <th data-field="min_max_3d_prob">3-day Min / Max (%)</th>
          </tr>
        </thead>
      </table>
    </div>

    <div id="area-table-explanation">
      <p>
        The forecasts shown provide the minimum and maximum percent chance of
        temporary closure for leases in each of the conditionally approved NC
        Division of Marine Fisheries shellfish growing areas. Individual
        leases within a larger shellfish growing area can have slightly
        different forecasts due to variation in rainfall forecasts and
        temporary closure criteria. As a result, there can be more than one
        percent chance of closure within shellfish growing areas.
      </p>
    </div>

  </div>
{% endblock %}
