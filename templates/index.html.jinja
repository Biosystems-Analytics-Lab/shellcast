{% extends "base.html.jinja" %}

{% block additional_head %}
  <!-- Bootstrap Table -->
  <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">
  <script defer src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>

  <!-- Custom JS -->
  <script defer src="https://maps.googleapis.com/maps/api/js?key= {{- mapsAPIKey -}} "></script>
  <script defer src="{{ url_for('static', filename='index/index.js') }}"></script>
  <!-- Custom CSS -->
  <link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='index/index.css') }}">
{% endblock %}

{% block content %}
  <div class="text-justify">
    <p id="disclaimer">
      ShellCast forecasts offer predictions that are in no way indicative of whether or not a
      growing area will actually be temporarily closed for harvest. Please only use ShellCast 
      for planning purposes. For official information on closures, refer to the
      <a href="http://portal.ncdenr.org/web/mf/proclamations-polluted-areas">North Carolina Division of Marine Fisheries</a> 
      or the <a href="https://ncdenr.maps.arcgis.com/apps/webappviewer/index.html?id=5759aa19d7484a3b82a8e440fba643aa">Shellfish Sanitation Temporary Closure Public Viewer</a>.
      Learn more about ShellCast forecasts on the <a href="/about">About</a> page.
    </p>
    <div class="d-flex justify-content-between flex-wrap">
      <p><strong>Last updated: {{lastUpdated}} ({{hoursAgo}} hours ago)</strong></p>
      <a href="#closure-tables">Table View</a>
    </div>
  </div>

  <div id="closure-map"></div>
  <label class="sr-only" for="closure-map" id="Map alt text">A satellite image of North Carolina with shellfish growing areas colored based on the percent chance of temporary harvest closure.</label>

  <br>

  <div id="closure-tables">

    <div id="lease-table-div">
      <div id="lease-table-toolbar">
        <h4>My Leases</h4>
      </div>
      <table
        id="lease-table"
        data-classes="table table-bordered table-hover table-sm"
        data-toggle="table"
        data-search="true"
        data-height="200"
        data-toolbar="#lease-table-toolbar">
        <thead>
          <tr>
            <th data-sortable="true" data-field="ncdmf_lease_id">Lease ID</th>
            <th data-field="prob_1d_perc">1-day (%)</th>
            <th data-field="prob_2d_perc">2-day (%)</th>
            <th data-field="prob_3d_perc">3-day (%)</th>
          </tr>
        </thead>
      </table>
    </div>

    <div id="lease-table-explanation">
      <p>
        To see forecasts for your lease sites and pins on the map, add leases to your account.
        The forecasts shown indicate the percent chance that a lease will close in 1, 2, or 3
        days due to expected rainfall. For example, if you are checking ShellCast on a Monday,
        the 1-day forecast would indicate the % chance of a lease closing on Tuesday, the 2-day
        forecast would indicate the % chance of a lease closing on Wednesday, and the 3-day 
        forecast would indicate the % chance of a lease closing on Thursday.
      </p>
    </div>

    <div id="area-table-div">
      <div id="area-table-toolbar">
        <h4>NCDMF Shellfish Growing Areas</h4>
      </div>
      <table
        id="area-table"
        data-classes="table table-bordered table-hover table-sm"
        data-toggle="table"
        data-search="true"
        data-height="200"
        data-toolbar="#area-table-toolbar">
        <thead>
          <tr>
            <th data-sortable="true" data-field="grow_area">Grow Area</th>
            <th data-field="min_max_1d_prob">1-day Min/Max (%)</th>
            <th data-field="min_max_2d_prob">2-day Min/Max (%)</th>
            <th data-field="min_max_3d_prob">3-day Min/Max (%)</th>
          </tr>
        </thead>
      </table>
    </div>

    <div id="area-table-explanation">
      <p>
        The forecasts shown indicate the maximum percent chance that leases within a
        NC Division of Marine Fisheries shellfish growing area will close in 1, 2, or
        3 days due to expected rainfall. For example, if you are checking ShellCast
        on a Monday, the 1-day forecast would indicate the % chance of a growing area
        closing on Tuesday, the 2-day forecast would indicate the % chance of a growing
        area closing on Wednesday, and the 3-day forecast would indicate the % chance
        of a growing area closing on Thursday.
      </p>
    </div>

  </div>
{% endblock %}
