{% extends "base.html.jinja" %}

{% block additional_head %}
  <!-- Bootstrap Table -->
  <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">
  <script defer src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>

  <!-- Custom JS -->
  <script defer src="https://maps.googleapis.com/maps/api/js?key= {{- mapsAPIKey -}} "></script>
  <script defer src="{{ url_for('static', filename='index/index.js') }}"></script>
  <!-- Custom CSS -->
  <link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='index/index.css') }}">
{% endblock %}

{% block content %}
  <div class="text-justify">
    <div class="date-info">
      <div>
        <p><strong>Last updated:</strong> {{lastUpdated}} ({{hoursAgo}} hours ago)</p>
      </div>
      <div>
        <p><strong>1-day:</strong> {{day1}}</p>
        <p><strong>2-day:</strong> {{day2}}</p>
        <p><strong>3-day:</strong> {{day3}}</p>
      </div>
      <a href="#closure-tables">Table View</a>
    </div>
    <p>Growing units shown below are colored by % chance of closure. The colors are defined in a legend on the map. For more information on the forecast, see the <a href="/about">About page</a>.</p>
  </div>

  <div id="closure-map"></div>
  <label class="sr-only" for="closure-map" id="Map alt text">
    Satellite imagery-based map of the North Carolina coast overlaid with
    shellfish growing unit polygons and shaded green, yellow, orange, and
    red based on the forecasted percent chance of closure for today,
    tomorrow, and in two days. When a user is logged into ShellCast they
    can also see map pins for the locations of their shellfish leases.
    Clicking on a map pin or shellfish growing unit polygon reveals the
    forecasted percent chance of closure for today, tomorrow, and in two
    days. These values can also be viewed in the “My Leases” and
    “Shellfish Growing Units” tables below the map.
  </label>

  <br>

  <div id="closure-tables">

    <div id="lease-table-div">
      <div id="lease-table-toolbar">
        <h4>My Leases</h4>
      </div>
      <table
        id="lease-table"
        data-classes="table table-bordered table-hover table-sm"
        data-toggle="table"
        data-search="true"
        data-height="200"
        data-toolbar="#lease-table-toolbar">
        <thead>
          <tr>
            <th data-sortable="true" data-field="ncdmf_lease_id">Lease ID</th>
            <th data-field="prob_1d_perc">1-day (%)</th>
            <th data-field="prob_2d_perc">2-day (%)</th>
            <th data-field="prob_3d_perc">3-day (%)</th>
          </tr>
        </thead>
      </table>
    </div>

    <div id="lease-table-explanation">
      <p>
        To see forecasts specifically for your lease sites and to add lease
        location pins to the map above, add leases to your account.
        You can add leases by clicking "Manage preferences" in the top right
        of this page.
      </p>
    </div>

    <div id="growing-unit-table-div">
      <div id="growing-unit-table-toolbar">
        <h4>NCDMF Shellfish Growing Units</h4>
      </div>
      <table
        id="growing-unit-table"
        data-classes="table table-bordered table-hover table-sm"
        data-toggle="table"
        data-search="true"
        data-height="200"
        data-toolbar="#growing-unit-table-toolbar">
        <thead>
          <tr>
            <th data-sortable="true" data-field="cmu_name">Growing Unit</th>
            <th data-field="prob_1d_perc">1-day (%)</th>
            <th data-field="prob_2d_perc">2-day (%)</th>
            <th data-field="prob_3d_perc">3-day (%)</th>
          </tr>
        </thead>
      </table>
    </div>

    <div id="growing-unit-table-explanation">
      <p>
        The forecasts shown provide the percent chance of temporary closure
        for leases in each of the conditionally approved NC Division of
        Marine Fisheries shellfish growing units.
      </p>
    </div>

  </div>
{% endblock %}
